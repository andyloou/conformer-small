nohup: ignoring input
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:21 - ============================================================
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:22 - ASR Training Script
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:23 - ============================================================
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:24 - Config file: config/conformer.yaml
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:25 - Output directory: from config
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:26 - Device: cuda
2025-10-07 00:45:56.861 | INFO     | __main__:<module>:27 - Resume checkpoint: None
2025-10-07 00:45:56.862 | INFO     | __main__:<module>:28 - W&B logging: Enabled
2025-10-07 00:45:56.862 | INFO     | __main__:<module>:29 - ============================================================
2025-10-07 00:45:57.323 | INFO     | vietasr.asr_task:run_train:261 - ========================================
2025-10-07 00:45:57.323 | INFO     | vietasr.asr_task:run_train:262 - START TRAINING ASR MODEL
2025-10-07 00:45:57.323 | INFO     | vietasr.asr_task:run_train:263 - ========================================
2025-10-07 00:45:57.323 | INFO     | vietasr.asr_task:run_train:264 - Config: {'model': {'features_extractor_params': {'global_cmvn_path': None}, 'num_mel_bins': 80, 'subsampling_channel': 176, 'subsampling_dropout': 0.1, 'type_encoder': 'conformer', 'type_decoder': 'transformer', 'sinusoidal_pos_enc_style': 'add', 'position_dropout': 0.1, 'encoder_params': {'d_model': 176, 'n_layers': 16, 'nhead': 4, 'dropout': 0.1, 'conv_kernel_size': 31, 'conv_mult': 1, 'ffn_mult': 4, 'pre_norm': True}, 'ctc_weight': 1.0, 'ctc_linear_dropout': 0.1, 'decoder_params': {'n_layers': 1, 'd_model': 176, 'n_head': 4, 'dropout': 0.1, 'pre_norm': True}, 'label_smoothing_weight': 0.0, 'label_smoothing_normalize_length': False}, 'preprocessor': {'sample_rate': 16000, 'normalize': 'per_feature', 'window_size': 0.025, 'window_stride': 0.01, 'window': 'hann', 'features': 80, 'n_fft': 512, 'log': True, 'frame_splicing': 1, 'dither': 1e-05, 'pad_to': 0, 'pad_value': 0.0}, 'dataset': {'use_huggingface': True, 'dataset_name': 'linhtran92/viet_bud500', 'max_duration': 15.0, 'target_sampling_rate': 16000, 'bpe_model_path': 'data/bpe_2000/bpe.model', 'batch_size': 32, 'num_worker': 12}, 'train': {'output_dir': 'exps/bud500/conformer', 'num_epoch': 30, 'warmup_steps': 10000, 'lr': 2.0, 'weight_decay': 0, 'acc_steps': 8, 'use_amp': True, 'pretrained_path': '/home/andyloou/conformer-small/vietasr/model_weights.pth', 'wandb_config': {'project': 'bud500-asr', 'tag': 'conformer-bud500-baseline'}}, 'decode': {'beam_size': 1, 'kenlm_path': None, 'word_vocab_path': 'data/word_vocab.txt', 'kenlm_alpha': 0.5, 'kenlm_beta': 1.5}}
/home/andyloou/conformer-small/vietasr/model.py:997: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location='cpu')
2025-10-07 00:45:57.813 | SUCCESS  | vietasr.asr_task:run_train:290 - Loaded pretrained encoder from: /home/andyloou/conformer-small/vietasr/model_weights.pth
2025-10-07 00:45:57.813 | INFO     | vietasr.asr_task:run_train:301 - Loading HuggingFace dataset: linhtran92/viet_bud500
2025-10-07 00:45:57.831 | INFO     | vietasr.asr_task:run_train:328 - [TRAIN] EPOCH 1/30 START
/home/andyloou/conformer-small/vietasr/asr_task.py:90: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(init_scale=2.**16, enabled=self.use_amp)
Loaded checkpoint from /home/andyloou/conformer-small/vietasr/model_weights.pth. Matched 646 keys (encoder only).
Skipped: 4 keys (e.g., ['preprocessor.featurizer.window', 'preprocessor.featurizer.fb', 'decoder.decoder_layers.0.weight', 'decoder.decoder_layers.0.bias'])
Decoder remains random (for Vietnamese vocab).
/home/andyloou/conformer-small/vietasr/asr_task.py:104: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled = True):  # Explicit device cho autocast
2025-10-07 00:49:35.277 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 100 | loss=0.8481794595718384 | ctc_loss=6.785435676574707 | decoder_loss=0.0
2025-10-07 00:49:35.286 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : gì nữa với lại nếu nó lấy dân thì cũng ở
2025-10-07 00:49:35.286 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:49:41.053 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 200 | loss=0.8390856981277466 | ctc_loss=6.712685585021973 | decoder_loss=0.0
2025-10-07 00:49:41.058 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : con cũng được ăn cơm với thịt
2025-10-07 00:49:41.058 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:49:47.024 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 300 | loss=0.8862183094024658 | ctc_loss=7.089746475219727 | decoder_loss=0.0
2025-10-07 00:49:47.029 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : có chút hụt hẫng nhưng hồng ánh suy nghĩ
2025-10-07 00:49:47.029 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:50:57.538 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 400 | loss=0.8309113383293152 | ctc_loss=6.6472907066345215 | decoder_loss=0.0
2025-10-07 00:50:57.542 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : rồi và một điều chúng ta hiểu là khi mà
2025-10-07 00:50:57.542 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:51:03.391 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 500 | loss=0.8450042009353638 | ctc_loss=6.76003360748291 | decoder_loss=0.0
2025-10-07 00:51:03.395 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : xong rồi bay đi bây giờ tính mới hiểu
2025-10-07 00:51:03.395 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:51:09.413 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 600 | loss=0.8365330696105957 | ctc_loss=6.692264556884766 | decoder_loss=0.0
2025-10-07 00:51:09.418 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : vô vàn trở ngại và khó khăn mọi chuyện
2025-10-07 00:51:09.418 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:51:15.415 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 700 | loss=0.8287031650543213 | ctc_loss=6.62962532043457 | decoder_loss=0.0
2025-10-07 00:51:15.419 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : chuyện này cô vẫn đang lo cho tính mạng
2025-10-07 00:51:15.419 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:52:44.884 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 800 | loss=0.846100926399231 | ctc_loss=6.768807411193848 | decoder_loss=0.0
2025-10-07 00:52:44.889 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : cuộc sống kiểu này nghe thì có vẻ ổn
2025-10-07 00:52:44.889 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:52:53.878 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 900 | loss=0.8262385129928589 | ctc_loss=6.609908103942871 | decoder_loss=0.0
2025-10-07 00:52:53.884 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : đấy mà không thấy ló mặt mũi ra ngoài
2025-10-07 00:52:53.884 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:53:02.775 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1000 | loss=0.8387513756752014 | ctc_loss=6.710011005401611 | decoder_loss=0.0
2025-10-07 00:53:02.782 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : cần có một cái cuộc nói chuyện chân tình
2025-10-07 00:53:02.782 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:53:10.721 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1100 | loss=0.8296918272972107 | ctc_loss=6.6375346183776855 | decoder_loss=0.0
2025-10-07 00:53:10.727 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : rồi và tôi nghĩ câu chuyện của duy nó
2025-10-07 00:53:10.727 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:08.539 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1200 | loss=0.8372499346733093 | ctc_loss=6.697999477386475 | decoder_loss=0.0
2025-10-07 00:54:08.544 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : đường ánh nắng vàng lồng vào cây cối tạo
2025-10-07 00:54:08.544 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:16.459 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1300 | loss=0.8199605941772461 | ctc_loss=6.559684753417969 | decoder_loss=0.0
2025-10-07 00:54:16.465 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : gì thuộc về thể xác và tâm hồn nàng
2025-10-07 00:54:16.465 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:24.103 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1400 | loss=0.828732967376709 | ctc_loss=6.629863739013672 | decoder_loss=0.0
2025-10-07 00:54:24.109 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : nói chuyện cùng cứ nghĩ đến cảnh hai
2025-10-07 00:54:24.109 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:42.538 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1600 | loss=0.8527357578277588 | ctc_loss=6.82188606262207 | decoder_loss=0.0
2025-10-07 00:54:42.545 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : mình sẽ hiểu được là mình không có kiến
2025-10-07 00:54:42.545 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:48.901 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1700 | loss=0.8336317539215088 | ctc_loss=6.66905403137207 | decoder_loss=0.0
2025-10-07 00:54:48.906 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : nhân loại cơ bản giống nhau và rõ ràng
2025-10-07 00:54:48.906 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:54:54.659 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1800 | loss=0.8524165153503418 | ctc_loss=6.819332122802734 | decoder_loss=0.0
2025-10-07 00:54:54.665 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : nghiêm hoàn toàn không nói cho tôi câu
2025-10-07 00:54:54.665 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: không
2025-10-07 00:55:00.431 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 1900 | loss=0.8296414613723755 | ctc_loss=6.637131690979004 | decoder_loss=0.0
2025-10-07 00:55:00.435 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : người thế nhưng điều đáng sợ là nó không
2025-10-07 00:55:00.435 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:55:06.430 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2000 | loss=0.8120976686477661 | ctc_loss=6.496781349182129 | decoder_loss=0.0
2025-10-07 00:55:06.434 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : ăn xong bữa tối thì cô hẹn tháng mai sẽ
2025-10-07 00:55:06.434 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:55:12.500 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2100 | loss=0.8408119678497314 | ctc_loss=6.726495742797852 | decoder_loss=0.0
2025-10-07 00:55:12.504 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : con của con con mới nhận về nuôi ông lực
2025-10-07 00:55:12.504 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:55:18.534 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2200 | loss=0.8267984390258789 | ctc_loss=6.614387512207031 | decoder_loss=0.0
2025-10-07 00:55:18.538 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : đấy nó đến từ lý thuyết về nhân quyền
2025-10-07 00:55:18.538 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:58:50.645 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2300 | loss=0.852718710899353 | ctc_loss=6.821749687194824 | decoder_loss=0.0
2025-10-07 00:58:50.649 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : cảm hứng và mong rằng với chủ đề này vào
2025-10-07 00:58:50.649 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:58:56.356 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2400 | loss=0.8243616223335266 | ctc_loss=6.594892978668213 | decoder_loss=0.0
2025-10-07 00:58:56.360 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : chẳng ai dám lại gần nhím nó phải sống
2025-10-07 00:58:56.360 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: com
2025-10-07 00:59:02.396 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2500 | loss=0.8136043548583984 | ctc_loss=6.5088348388671875 | decoder_loss=0.0
2025-10-07 00:59:02.400 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : ở nơi cao ráo sạch sẽ đó
2025-10-07 00:59:02.400 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 00:59:08.539 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2600 | loss=0.7962473034858704 | ctc_loss=6.369978427886963 | decoder_loss=0.0
2025-10-07 00:59:08.543 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : có những cái là mình phân tích những cái
2025-10-07 00:59:08.544 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: tôi
2025-10-07 01:00:26.193 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2700 | loss=0.8618180155754089 | ctc_loss=6.8945441246032715 | decoder_loss=0.0
2025-10-07 01:00:26.197 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : nữa hay là anh để em đưa sang về nhà
2025-10-07 01:00:26.197 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:00:37.758 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 2900 | loss=0.8354132771492004 | ctc_loss=6.6833062171936035 | decoder_loss=0.0
2025-10-07 01:00:37.763 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : thực thi như anh trường cũng đã đề cập
2025-10-07 01:00:37.763 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:00:43.569 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3000 | loss=0.818943977355957 | ctc_loss=6.551551818847656 | decoder_loss=0.0
2025-10-07 01:00:43.574 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : được vậy anh chở em qua nhà thay quần áo
2025-10-07 01:00:43.574 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:02:03.222 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3100 | loss=0.8269006013870239 | ctc_loss=6.615204811096191 | decoder_loss=0.0
2025-10-07 01:02:03.226 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : mình đã quên được nhưng không phải
2025-10-07 01:02:03.226 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:02:09.061 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3200 | loss=0.8235161900520325 | ctc_loss=6.58812952041626 | decoder_loss=0.0
2025-10-07 01:02:09.066 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : với họ ngay cả những người tưởng chừng
2025-10-07 01:02:09.066 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:02:14.997 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3300 | loss=0.8368606567382812 | ctc_loss=6.69488525390625 | decoder_loss=0.0
2025-10-07 01:02:15.001 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : thương vừa hận cậu cũng chẳng biết phải
2025-10-07 01:02:15.001 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: có
2025-10-07 01:03:26.462 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3400 | loss=0.8486121892929077 | ctc_loss=6.788897514343262 | decoder_loss=0.0
2025-10-07 01:03:26.467 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : lập tức cảm xúc của duy khang liền được
2025-10-07 01:03:26.467 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: 
2025-10-07 01:03:32.006 | INFO     | vietasr.asr_task:train_one_epoch:145 - [TRAIN] EPOCH 1 | BATCH 3500 | loss=0.842422366142273 | ctc_loss=6.739378929138184 | decoder_loss=0.0
2025-10-07 01:03:32.010 | WARNING  | vietasr.asr_task:train_one_epoch:148 - + Label  : thậm chí là phải khen luôn khen trước
2025-10-07 01:03:32.010 | WARNING  | vietasr.asr_task:train_one_epoch:149 - + Predict: không không
2025-10-07 02:03:32.931 | ERROR    | __main__:<module>:57 - Training failed with error: float division by zero
Traceback (most recent call last):
  File "/home/andyloou/conformer-small/train.py", line 59, in <module>
    raise e
  File "/home/andyloou/conformer-small/train.py", line 50, in <module>
    task.run_train()
  File "/home/andyloou/conformer-small/vietasr/asr_task.py", line 329, in run_train
    train_stats = self.train_one_epoch()
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/andyloou/conformer-small/vietasr/asr_task.py", line 162, in train_one_epoch
    "train_loss": train_loss_epoch / batch_count,
                  ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
ZeroDivisionError: float division by zero
